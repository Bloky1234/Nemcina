<!DOCTYPE html>

<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- mobiln√° kompatibilita -->
  <title>Uƒçenie slov√≠ƒçok</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
    #loader { margin: 20px; }
    .options { display: flex; flex-direction: column; max-width: 250px; margin: 20px auto; }
    button { margin: 5px; padding: 12px; border-radius: 8px; border: 1px solid #ccc; cursor: pointer; font-size: 16px; }
    button:hover { background: #f0f0f0; }
    .correct { background: #b6fbb6 !important; }
    .wrong { background: #ffb6b6 !important; }
    .radio-group { margin: 15px 0; font-size: 16px; }
    .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .home-btn { padding: 8px 12px; border: none; background: #007BFF; color: white; border-radius: 6px; cursor: pointer; font-size: 14px; }
    .home-btn:hover { background: #0056b3; }
  </style>
</head>
<body>
  <h1>Uƒçenie slov√≠ƒçok</h1>

  <div id="loader">
    <div class="radio-group">
      <label><input type="radio" name="smer" value="en-sk" checked> Angliƒçtina ‚Üí Slovenƒçina</label><br>
      <label><input type="radio" name="smer" value="sk-en"> Slovenƒçina ‚Üí Angliƒçtina</label><br>
      <label><input type="radio" name="smer" value="mix"> Mix (oboma smermi)</label>
    </div>
    <button class="home-btn" onclick="startQuiz()">Spusti test</button>
  </div>

  <div id="quiz" style="display:none;">
    <div class="top-bar">
      <h2 id="question"></h2>
      <button class="home-btn" onclick="goHome()">Domov</button>
    </div>
    <div class="options" id="options"></div>
  </div>

  <script>
    let slovicka = [];
    let nezodpovedane = [];
    let smer = "en-sk";
    let spravne = 0;
    let nespravne = 0;

    document.querySelectorAll('input[name="smer"]').forEach(radio => {
      radio.addEventListener("change", e => smer = e.target.value);
    });

    async function startQuiz() {
      const response = await fetch("slovicka.txt");
      const text = await response.text();
      slovicka = text.split("\n").map(r => {
        const [en, sk] = r.trim().split("-");
        return { en, sk };
      }).filter(x => x.en && x.sk);

      nezodpovedane = [...slovicka];
      spravne = 0;
      nespravne = 0;

      document.getElementById("loader").style.display = "none";
      document.getElementById("quiz").style.display = "block";
      novaOtazka();
    }

    function novaOtazka() {
      if (nezodpovedane.length === 0) {
        document.getElementById("quiz").innerHTML = `
          <h2>Hotovo! üéâ</h2>
          <p>Spr√°vne odpovede: ${spravne}</p>
          <p>Nespr√°vne odpovede: ${nespravne}</p>
          <button class="home-btn" onclick="goHome()">Domov</button>
        `;
        return;
      }

      const otazka = nezodpovedane[Math.floor(Math.random() * nezodpovedane.length)];
      let realSmer = smer === "mix" ? (Math.random() < 0.5 ? "en-sk" : "sk-en") : smer;

      let questionText, correctAnswer, allAnswers;

      if (realSmer === "en-sk") {
        questionText = `Prelo≈æ: ${otazka.en}`;
        correctAnswer = otazka.sk;
        allAnswers = slovicka.map(s => s.sk);
      } else {
        questionText = `Prelo≈æ: ${otazka.sk}`;
        correctAnswer = otazka.en;
        allAnswers = slovicka.map(s => s.en);
      }

      document.getElementById("question").innerText = questionText;

      let moznosti = [correctAnswer];
      while (moznosti.length < 4 && allAnswers.length >= 4) {
        const nahodne = allAnswers[Math.floor(Math.random() * allAnswers.length)];
        if (!moznosti.includes(nahodne)) moznosti.push(nahodne);
      }
      moznosti = moznosti.sort(() => Math.random() - 0.5);

      const optionsDiv = document.getElementById("options");
      optionsDiv.innerHTML = "";
      moznosti.forEach(moz => {
        const btn = document.createElement("button");
        btn.textContent = moz;
        btn.onclick = () => {
          if (moz === correctAnswer) {
            btn.classList.add("correct");
            spravne++;
            nezodpovedane = nezodpovedane.filter(s => s !== otazka);
            setTimeout(novaOtazka, 700);
          } else {
            btn.classList.add("wrong");
            nespravne++;
          }
        };
        optionsDiv.appendChild(btn);
      });
    }

    function goHome() {
      document.getElementById("quiz").style.display = "none";
      document.getElementById("loader").style.display = "block";
      slovicka = [];
      nezodpovedane = [];
      spravne = 0;
      nespravne = 0;
      document.getElementById("options").innerHTML = "";
      document.getElementById("question").innerText = "";
    }
  </script>

</body>
</html>
